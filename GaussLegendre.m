function res = GaussLegendre(f,n,a,b)
% Gauss-Legendre方法数值积分
% 输入
%   f是输入函数，n+1多项式次数，a，b区间端点
% 输出
%   res近似解
A = [1]; % 1行1列的矩阵
A = [A, 0;5/9,8/9]; % 2行2列的矩阵
A = [A;1/2+1/12*sqrt(10/3),1/2-1/12*sqrt(10/3)]; % 3行2列

A = [A,[0,0,0]';3/10*(-0.7+5*sqrt(0.7))/(-2+5*sqrt(0.7)),...
    3/10*(0.7+5*sqrt(0.7))/(2 +5*sqrt(0.7)),128/225]; % 4行3列

A = [A;0.171324492379170,0.360761573048193,0.467913934572691]; % 5行3列

A = [A,[0,0,0,0,0]';0.129484966168870,0.279705391489277, ...
    0.381830050505119,0.417959183373469];

A = [A;0.101228536290376, 0.222381034453374, 0.313706645877887, 0.362683783378362]; 
A(1,5) = 0;
A = [A;0.081274388361574,0.180648160694857,0.260610696402935,...
    0.312347077040003,0.330239255001260];

X = 1/sqrt(3); 
X = [X;sqrt(3/5)]; 
X = [X,[0;0];sqrt((3 -4* sqrt(0.3))/7), sqrt((3+4*sqrt(0.3))/7) ];
X = [X;sqrt(5-2*sqrt(10/7))/3,sqrt(5 +2*sqrt(10/7))/3]; 
X(1,3) =0;
X = [X;0.9324695142, 0.6612093865, 0.2386191861; 0.9491079123, 0.7415311856,0.4058451514]; 
X(1,4) =0;
X = [X; 0.9602398565, 0.7966664774, 0.5255524099 , 0.1834346425;...
    0.9681602395,0.8360311073,0.6133714327,0.3242534234];
% 区间变换
a1 = (b-a)/2;b1=(a+b)/2;
fv = 0; m = floor((n+1)/2);
for p=1:m
    fv = fv + A(n,p)*(feval(f,a1*X(n,p)+b1)+feval(f,-a1*X(n,p)+b1));
end
if m<(n+1)/2
    fv = fv + A(n,m+1)*feval(f,b1);
end
res = fv * a1;
fprintf('计算结果：%.14f\n', res);
% 程序结束


